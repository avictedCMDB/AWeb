<%@ page language="java" contentType="text/html; charset=gbk" pageEncoding="GBK"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>供应商管理中心|中航招标网</title>
<link href="${pageContext.request.contextPath}/static/css/bootstrap.css" rel="stylesheet"/>
<link href="${pageContext.request.contextPath}/static/css/common.css" rel="stylesheet"/>
<link href="${pageContext.request.contextPath}/static/css/supplier_common.css" rel="stylesheet"/>
<link href="${pageContext.request.contextPath}/static/css/supplier_nonstandard.css" rel="stylesheet"/>
<link href="${pageContext.request.contextPath}/static/fonts/font-awesome/css/font-awesome.css" rel="stylesheet"/>
<!-- Fontello CSS -->
<link href="${pageContext.request.contextPath}/static/fonts/fontello/css/fontello.css" rel="stylesheet"/>
<script type="text/javascript" src="${pageContext.request.contextPath}/static/js/jquery.js"></script>
<script type="text/javascript" src="${pageContext.request.contextPath}/static/js/rollover.js"></script>
<script type="text/javascript" src="${pageContext.request.contextPath}/static/js/jquery.imgbox.pack.js"></script>
<script type="text/javascript" src="${pageContext.request.contextPath}/static/js/supplierUtil.js"></script>
<script type="text/javascript">
$(document).ready(function(){
	<c:forEach var="image" items="${supplierOrderContract.supplierGoodsImages}" varStatus="status">
		$("#img_${status.index}").imgbox();
	</c:forEach>

	});
<c:if test="${ok == '1'}">
alert("上传的文件为空文件，请检查问候重新上传！");
</c:if>
<c:if test="${ok == '2'}">
alert("上传的文件解析失败，请使用指定的模板文件！");
</c:if>
<c:if test="${ok == '3'}">
alert("上传成功！");
</c:if>
function updateStatus(action,checkSize,returnAction){
	if(checkSize == 0){
		alert('请上传非标商品！');
		return ;
	}
	$.ajax({

	     type: 'POST',

	     url: action ,

		    data : {
			'id' : $('#id').val(),
			'filePath' : $('#filePath').val()
		} ,

	    success: function (data){
	    	window.location.href=returnAction;
	    } ,

	    dataType: 'json',
	    
	    cache:false,
	});
}


</script>
</head>

<body>
<div class="page-wrapper">
 <jsp:include page="../header.jsp" />
  <div id="contents">
    <div class="inner">
      <div id="matter_section" class="inner_main">
      	<h2>非标商品管理</h2>
      	<div id="info_list">
            <div class="section_inner">
              <dl class="clearfix">
                  <dt>商品描述：</dt>
                  <dd><textarea class="form-control" disabled="disabled" rows="4">${supplierOffStandRequire.goodsDescNew}</textarea></dd>
              </dl>
              <dl class="clearfix">
                  <dt>商品图纸：</dt>
                  <dd>
                      <div class="detail_list">
                            <ul class="clearfix">
                                <c:forEach var="image" items="${supplierOffStandRequire.imageList}" varStatus="status">
	                      			<li>
	                      				<a id="img_${status.index}" href="${pageContext.request.contextPath}${image.url}"><img src="${pageContext.request.contextPath}${image.url}"/></a>
	                      			</li>
	                      		</c:forEach>
                            </ul>
                        </div>
                  </dd>
              </dl>
              <form id="uploadForm" method="post">
              <c:if test="${type == '1'}">
	              <dl class="clearfix last">
	                  <dt>导入商品：</dt>
	                  <dd>
	                  	  <input type="hidden" name="id" id="id" value="${supplierOffStandRequire.id}"/>
	                  	  <input type="hidden" name="filePath" id="filePath" value="${filePath}"/>
	                      <input id="file" name="uploadFile" type="file" style="display:none"/>
	                        <div class="input-append">
	                            <input id="photoCover" class="form-control" type="text" style="height:30px; width: 350px; margin-left: 0; margin-top: 1px;"/>
	                            <a class="btn btn-default red" onclick="$('input[id=file]').click();">浏览文件</a>
	                            <button type="button" class="btn btn-default red" onclick="upload('${pageContext.request.contextPath}/supplier/offStandRequire/uploadGoods?type=1')" id= "uploadButton">开始上传</button>
	                            <a href="${pageContext.request.contextPath}/supplier/goodsInfo/download?type=2" class="download">非标准模板下载</a>
	                        </div>
	                        <script type="text/javascript"> 
	                            $('input[id=file]').change(function() {
	                                $('#photoCover').val($(this).val());
	                            });
	                            function upload(action){
	                            	$('#uploadButton').attr('disabled',"true");
	                            	$('#uploadForm').attr('enctype', 'multipart/form-data'); 
	                            	document.getElementById("uploadForm").action=action;
	                            	document.getElementById("uploadForm").submit();
	                            }
	                        </script>
	                  </dd>
	              </dl>
              </c:if>
              </form>
            <p>
          	<c:if test="${ok != null}">
	          	导入总条数：${count} 成功条数：${sussCount}  失败条数：${errCount}<br/> 
	          	<c:if test="${errMsg != ''}">
	          		错误行数：${errMsg}
	          	</c:if>
          	</c:if>
          </p>
              <div class="search_result section">
          <table border="0">
            <tr>
              <th>商品名称</th>
              <th width="335">规格型号</th>
              <th width="150">材质</th>
              <th width="120">品牌</th>
              <th width="120" class="last">价格</th>
            </tr>
            <c:forEach var="supplierGoodInfo" items="${supplierGoodInfoList}" varStatus="status">
	            <tr>
	              <td>${supplierGoodInfo.goodsName}</td>
	              <td>${supplierGoodInfo.goodsModel}</td>
	              <td>${supplierGoodInfo.goodsStuff}</td>
	              <td>${supplierGoodInfo.brandName}</td>              
	              <td>${supplierGoodInfo.countPrice}</td>
	            </tr>
            </c:forEach>
          </table>
        <!--.search_result--></div>
              <div class="btn_list_check">
                  <ul class="list-inline clearfix">
                  	  <c:if test="${type == '1'}">
                  	 	<li><button type="button" class="btn btn-default add_btn" onclick="updateStatus('${pageContext.request.contextPath}/supplier/offStandRequire/updateStatus','${fn:length(supplierGoodInfoList)}','${pageContext.request.contextPath}/supplier/offStandRequire')">提供</button></li>
                  	  </c:if>
                      <li><button type="button" class="btn btn-default add_btn" onclick="redirectPage('${pageContext.request.contextPath}/supplier/offStandRequire')">返回</button></li>
                  </ul>
              </div>
            </div>
        </div>
      	
      <!--#matter_section-->	
      </div>
    <!--.inner--></div>
  <!--#contents--></div>
  <jsp:include page="../footer.jsp" />
<!--.page-wrapper--></div>
</body>
</html>
